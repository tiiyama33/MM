# よく使うエクセルの関数

表計算ソフト「エクセル」では、セルの先頭に = (イコール)を入力することで数式や関数を使用することができます。　　
よく使う 関数 を列挙します。

>正確には ^ や * は関数ではなく、「<a href="https://support.office.com/ja-jp/article/%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%A8-Excel-%E3%81%A7%E3%81%AE%E5%84%AA%E5%85%88%E9%A0%86%E4%BD%8D-48be406d-4975-4d31-b2b8-7af9e0e2878a">演算子</a>」です。

<table>
<thead>
<tr>
<td>関数(演算子)</td>
<td>内容</td>
<td>使用例</td>
</tr>
</thead>
<tbody>
<tr>
<td>sqrt</td>
<td>ルートの計算<br> (例: $\sqrt{2}$)<br>
(累乗を使っても計算できる)</td>
<td>=sqrt(2)
=2^(1/2)</td>
</tr>
<tr>
<td>^</td>
<td>累乗<br> (例: $2^3, 2^{-1}$)<br>
(記号はハット、またはキャレットと読む。キーボード右上￥の隣にキーがある)</td>
<td>=2^3<br>
=2^(-1)<br>
=2^-1  でもOK(注1) </td>
</tr>
<tr>
<td>sum</td>
<td>セルの値の合計 (例: A1セル～A9セルの9セルに入っている数値を合計する)
(セルの始点と終点を : (コロン) で区切って入力。マウス操作でも指定できる)</td>
<td>=sum(A1:A9)</td>
</tr>
<tr>
<td>*</td>
<td>掛け算 (例: $` \displaystyle 2 \times 3, 2(1+2) `$)
(記号はアスタリスクと読む。数学では掛け算記号 × は省略できるが、エクセルでは省略できない)</td>
<td>=2*3
=2*(1+2)</td>
</tr>
<tr>
<td>/</td>
<td>割り算 (例: $` \displaystyle \frac{2}{3}, \frac{2}{1+3} `$)
(記号はスラッシュと読む。必要に応じ分母や分子をカッコで囲う)</td>
<td>=2/3
=2/(1+3) 　　注 ((<a href="http://science.shinshu-u.ac.jp/~tiiyama/?page_id=5585#slash">2/1+3 という入力は通常の演算では 1/2 となることが期待されます</a>が、エクセルではかっこをつけないと(2/1)+3と解釈され、 5 となります。))</td>
</tr>
<tr>
<td>sin</td>
<td>三角関数、サイン
(入力はラジアンで行わなくてはならない。度で入力したいときは度をラジアンに変換する関数 radians を使う)</td>
<td>=sin(pi()/6)
=sin(radians(30))</td>
</tr>
<tr>
<td>radians</td>
<td>度をラジアンに変換</td>
<td>=radians(30)</td>
</tr>
<tr>
<td>degrees</td>
<td>ラジアンを度に変換</td>
<td>=degrees(pi()/6)</td>
</tr>
<tr>
<td>pi</td>
<td>円周率 π
(カッコの中には何も記入しない)</td>
<td>=pi()</td>
</tr>
<tr>
<td>sinh</td>
<td><a href="https://ja.wikipedia.org/wiki/%E5%8F%8C%E6%9B%B2%E7%B7%9A%E9%96%A2%E6%95%B0">双曲線関数</a>、ハイパボリックサイン</td>
<td>=sinh(pi()/6)</td>
</tr>
<tr>
<td>asin</td>
<td>逆三角関数、アークサイン
( $`\sin^{-1} x `$ と書かれるが、サインの逆数 $`\displaystyle \frac{1}{\sin x}`$ではない。
sin は $`\displaystyle \frac{\pi}{6}`$ (= 30°) を入れると $`\displaystyle \frac{1}{2}`$ を返す関数だが、
sin<sup>−1</sup> はその反対で $`\displaystyle \frac{1}{2}`$ を入れると $`\displaystyle \frac{\pi}{6}`$ を返す関数。(<strong>逆関数</strong>という)
エクセルでは asin 関数を使って計算できる。)</td>
<td>=asin(0.5)</td>
</tr>
<tr>
<td>exp</td>
<td>e を底とする指数関数 (例: $` \mathrm e^2 `$)</td>
<td>=exp(2)</td>
</tr>
<tr>
<td>ln</td>
<td>自然対数 (例: $` \ln 2 \equiv \log_{\mathrm e} 2 `$)
(対数関数は負の値を入力するとエラーになる)</td>
<td>=ln(2)</td>
</tr>
<tr>
<td>log10</td>
<td>常用対数 (例: $` \log_{10} 1000 `$)</td>
<td>=log10(1000)
=log(1000)</td>
</tr>
<tr>
<td>log</td>
<td>対数 (例: $` \log_2 8`$)
(カンマで区切って、2つめの数値で底を指定する。2つめの数値を省略すると底は10になる)</td>
<td>=log(8,2)</td>
</tr>
</tbody>
</table>

## 注1 [エクセルの演算順序]
2^-1 でもOKなのはいいのですが、少し落とし穴があります。  
−(マイナス)という記号には2種類の使われ方があります。  
前に数字がある場合(3−1など)は3から1を引く、[減算]を意味しています。  
一方、前に数字がない場合(−2など)は後ろの2が負であるという、[負値]を意味しています。  
2^-1 の − は[負値]を表す−として使われています。  
<a href="https://support.office.com/ja-jp/article/%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%A8-Excel-%E3%81%A7%E3%81%AE%E5%84%AA%E5%85%88%E9%A0%86%E4%BD%8D-48be406d-4975-4d31-b2b8-7af9e0e2878a">エクセルの演算の優先順位</a>をみると、「負値を表す−(マイナス)」と「減算を表す−(マイナス)」 の演算順序が違っており、  
演算順は「負値の−」&gt;「累乗^」&gt;「減算の−」になっています。  
2^−1は[負値の−]が[ハット]より演算順序が早いため、2^(-1)として処理されるわけです。  
これが別の演算では弊害となる場合があります。  
例えば、-2^2 は通常の数学演算では -4 となるのを期待するのですが、エクセルでは(-2)^2と解釈され、 4 となります。  
これを防ぐには、かっこを使って -(2^2)と書く必要があります。 
