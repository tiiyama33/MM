# 分子の座標ファイルを作成する
## エディタを使って座標ファイルを作る
VESTA が表示する分子の構造(原子の位置)は、座標ファイルの中に書かれています。  
先ほど使った、エタノール分子の座標ファイル ethanol.xyz の中(実体)を見てみましょう。  

実体を見るためには [エディタ] と呼ばれるソフトウェアを使います。  
この授業では [メモ帳] (NotePad)を使います。 [メモ帳] は Windows 標準添付のソフトウェアです。   

[メモ帳] は [スタートメニュー]-[すべて] のリストの下の方(ま行)にあると思います。(場所が違う可能性あり)  

| <img class="size-medium wp-image-195899" src="/img/memo11.png" alt="" width="288" height="300" />|
|:---:|
|「メモ帳」の起動 (スタートメニュー)|

> Mac OS Xの場合、標準で搭載されている[テキストエディタ]が使えます。  
> 起動時は[リッチテキスト]モードになっているので、[テキストエディット]-[環境設定...]-[フォーマット]で [標準テキスト]モードに切り替えてください。  
> 拡張子(ファイル名の最後の部分)は強制的に .txt となってしまうので、ファイルをセーブした後、ファイル名末尾を .xyz に直してください。


ダウンロードした ethanol.xyz を、起動した [メモ帳] に Drag & Drop、または [ファイル]-[開く] で 開いてください。  

 |<img class="wp-image-8165 size-medium" src="/img/notepad11.png" width="600" />|
 |:---:|
 |「メモ帳」でethanol.xyzを開いたところ|

ethanol.xyz は "XMol XYZ" 形式に従って書かれています。  
(ファイルの拡張子は .xyz )

"XMol XYZ" 形式は分子の情報を以下のように書くように定められています。

- 1 行目 原子の個数を書く
- 2 行目 分子の名称を書く(日本語禁止)
- 3 行目以降  
  1 行が 1 つの原子の情報を表している。  
  それぞれの行には各原子の元素記号 *x* 座標 *y* 座標 *z* 座標  
を書く。
**座標は Å (オングストローム) 単位** (1 Å = 10<sup>-10</sup> m )。  
**元素記号と各座標の間はスペースで区切る。**  
(スペースの数は何個でも良い。ただし、全角スペースは使わないこと。タブ(Tab) も区切りに使えるが、タブの場合は 2 個以上連続して並べてはいけない。)

つまり、原子の座標を調べ、上のようなフォーマットで 拡張子を .xyz としたファイルを作れば、どのような分子でも図に描くことができます。

>[!important]
> ### 問題 4 メタン
> 下記の座標を利用してメタン分子の座標ファイルを作成し、それを使ってメタンの分子模型を図示せよ。  
> またVESTAを用いてメタン分子のH-C-H結合角を求めよ。
>
> <img class="size-full wp-image-3266 " title="methane" src="/img/methane1.jpg" alt="" width="600" height="267" />

[メモ帳] で、[ファイル]-[新しいタブ] を選んで新しいファイルを開き、"XMol XYZ" 形式に従って上記の座標を入力します。以下の点に注意してください。  

- ファイルの中では全角文字は使わない。
- 1行目は原子数を入力
- 2行目は分子名(methane または CH4) を入力
- 3行目以降は、元素名、xyz座標をスペースで区切り入力
  
座標データが入力できたら、[ファイル]-[名前をつけて保存]を選び、  
ファイルの種類を **[すべてのファイル]** に変更して、methane.xyz という名前でセーブしてください。

<img class="alignnone size-medium wp-image-8166" src="/img/save1-300x200.png" alt="save1" width="450" /></a>

> ファイルの種類を [テキストファイル] のままでセーブすると、ファイル名が methane.xyz.txt となってしまうようです。その場合、できたファイルの名前を変更して最後の .txt を消してください。

うまく入力できていれば、作ったファイル(methane.xyz) を VESTA で開くとメタンの分子模型が表示されるはずです。

> 1カ所でも間違いがあると、VESTAで開いたときに、VESTAがエラーを出して強制終了してしまうことがあります。
> その場合はよくファイルの内容を見直してください。
>
> 間違いの例
> - 1行目の原子数が違っていた
> - 2行目が抜けていた
> - 数値の小数点がカンマになっていた
> - 区切りのスペースが抜けていた
> - スペースや数字に全角文字を使っていた
> - 1つの数値に小数点を2回使っていた
> - 小数点をつけるのを忘れて、ものすごく遠いところに原子を描いていた　など


## エクセルを使って座標を計算する
次に、水分子とベンゼン分子を描いてみましょう。ただし、原子の位置は自分で計算してもらいます。
次の問題 5 を行ってください。

>[!important]
> ### 問題 5 水、ベンゼン
> (1) 水蒸気の赤外、ラマンスペクトルの研究によると、  
> 水分子の O-H 結合距離は 0.9575 Å、H-O-H 結合角は 104.31° である。  
> 水分子の構造モデルを図示せよ。
>
> (2) 同じく、ベンゼン分子 (C<sub>6</sub>H<sub>6</sub>) の C-C 結合距離は 1.397 Å、C-H 結合距離は 1.076 Å である。
> ベンゼン分子の構造モデルを図示せよ。
> (どこを原点(*x* = 0, *y* = 0, *z* = 0)にすれば計算が楽か、よく考えてください。必ずしも原点に原子がある必要はありません。)

座標計算は、エクセルを使って行います。
次の方法で、エクセルを使って xyz ファイルに入力するデータを作成することができます。

|<img class="size-full wp-image-3269 " title="excel" src="/img/excel.png" alt="" width="630" height="425" />|
|:---:|
|エクセルで座標を並べたところ (例はメタン分子。数値は正しい値ではありません)|


- 上図のように、xyz 形式に合うように原子数や元素名、座標をエクセルのセルに並べる (座標は三角関数を使って計算する)
- 上図のように、xyz 形式の部分を選択して [コピー] する
- [メモ帳] を立ち上げ新しいファイルを開く
(すでにファイルが開かれているときは、[ファイル]-[新規作成] で新しいファイルを作成する)
- [メモ帳] に [ペースト] する
([メモ帳]にペーストすると、数式ではなく答えの「数値」が貼り付けられます)</li>
- .xyz をつけたファイル名でセーブする


|<img class="size-full wp-image-3270 " title="paste" src="/img/paste.png" alt="" width="511" height="274" /> |
|:---:|
|エディタにペーストしたところ|

これでエクセルから [メモ帳] にデータを移動し、.xyz ファイルを作る方法が分かりました。

各原子の座標はエクセル上で三角関数を使って計算します。
エクセルから[メモ帳]にペーストする際には、数式ではなく答えの数値が貼り付けられますので、エクセル上では例えば
```
=10∗sin(radians(30))
```
というように、直接数式を入力してかまいません。

エクセルでの三角関数の使い方を下に書いておきます。角度として **ラジアン** を使うことに注意してください。  
水とベンゼン分子のモデルを順に作成してください。

**分子模型を製作後、計算が合っているかどうか VESTA 上で原子間距離や角度を確かめてみること！**

>[!note]
> ### エクセルによる三角関数の計算
> sin30° → = sin(30 * 3.14/180)  
> または → = sin(30 * pi()/180)  
> または → = sin(radians(30))  
>(いずれも 30° をラジアンに変換してから sin に入れている)  
>  
>※ pi() は円周率を返す関数。(かっこの中には何も入れない)
>  
>radians() は度をラジアンに変換する関数。  
>ラジアン→度の変換は degrees() で行える。  
>他、[よく使うエクセルの関数](/tips/excelfunc.md)を参照してください。  
>^ (ハット) 累乗 (2の3乗 → =2^3),  
>log() 常用対数,  
>ln() 自然対数,  
>exp() 指数関数 (eの3乗 → =exp(3) )  
>sqrt() ルート(ルート2→ = sqrt(2) 、=2^(1/2)でも同じ)  
>など。


>[!important]
> ### 問題 5-2 炭化水素類; 余剰問題
>(余裕のある人は挑戦してください。)
>
>次の分子を図示せよ。
> - エタン(C<sub>2</sub>H<sub>6</sub>) (ねじれ型配座が最安定)
> C-C-H 結合角 109.6°、C-C 結合距離 154 pm、C-H 結合距離 110 pm
> - エチレン(C<sub>2</sub>H<sub>4</sub>)
>C-C-H 結合角 121.7°、C-C 結合距離 133 pm、C-H 結合距離 108 pm
> - アセチレン(C<sub>2</sub>H<sub>2</sub>)
>C-C-H 結合角 180°、C-C 結合距離 120 pm、C-H 結合距離 106 pm
>
>1 pm (ピコメートル) = 0.01 Å

[前＜](molecule.md) [目次](/README.md) [＞次](solid.md)
